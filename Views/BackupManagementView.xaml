<UserControl x:Class="DOInventoryManager.Views.BackupManagementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1200">
    
    <UserControl.Resources>
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
        </Style>
        
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
            <Setter Property="Margin" Value="0,20,0,10"/>
        </Style>
        
        <Style x:Key="ActionButtonStyle" TargetType="Button">
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="MinWidth" Value="140"/>
        </Style>
        
        
        <Style x:Key="InfoCardStyle" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource CardBackgroundBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderSubtleBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
    </UserControl.Resources>
    
    <TabControl>
        
        <!-- Backup Management Tab -->
        <TabItem Header="ðŸ—„ï¸ Backup Management">
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Header -->
                    <TextBlock Grid.Row="0" Text="ðŸ—„ï¸ Backup Management" Style="{StaticResource HeaderTextStyle}"/>
                    
                    <!-- Current Status Section -->
                    <Grid Grid.Row="1" Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Last Backup Card -->
                        <Border Grid.Column="0" Style="{StaticResource InfoCardStyle}">
                            <StackPanel>
                                <TextBlock Text="ðŸ“… Last Backup" FontWeight="SemiBold" FontSize="14" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <TextBlock x:Name="LastBackupText" Text="Never" FontSize="16" FontWeight="Bold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <TextBlock x:Name="LastBackupOperationText" Text="" FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Total Backups Card -->
                        <Border Grid.Column="1" Style="{StaticResource InfoCardStyle}">
                            <StackPanel>
                                <TextBlock Text="ðŸ“Š Total Backups" FontWeight="SemiBold" FontSize="14" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <TextBlock x:Name="TotalBackupsText" Text="0" FontSize="16" FontWeight="Bold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <TextBlock x:Name="TotalBackupSizeText" Text="0 MB" FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Database Size Card -->
                        <Border Grid.Column="2" Style="{StaticResource InfoCardStyle}">
                            <StackPanel>
                                <TextBlock Text="ðŸ’½ Database Size" FontWeight="SemiBold" FontSize="14" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <TextBlock x:Name="DatabaseSizeText" Text="0 MB" FontSize="16" FontWeight="Bold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <TextBlock Text="Current active database" FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Backup Folder Card -->
                        <Border Grid.Column="3" Style="{StaticResource InfoCardStyle}">
                            <StackPanel>
                                <TextBlock Text="ðŸ“ Backup Location" FontWeight="SemiBold" FontSize="14" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <Button x:Name="OpenFolderBtn" Content="Open Folder" Click="OpenFolder_Click" 
                                        Style="{StaticResource FluentButtonStyle}" FontSize="12" MinWidth="100" Padding="8,4"/>
                                <TextBlock x:Name="BackupFolderText" Text="Documents\DO Inventory Backups" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                    
                    <!-- Action Buttons Section -->
                    <Grid Grid.Row="2" Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <Button Grid.Column="0" x:Name="CreateBackupBtn" Content="ðŸ—„ï¸ Create Backup" Click="CreateBackup_Click" 
                                Style="{StaticResource FluentSuccessButtonStyle}" Margin="0,0,10,0"/>
                        
                        <Button Grid.Column="1" x:Name="RestoreBackupBtn" Content="ðŸ”„ Restore Backup" Click="RestoreBackup_Click" 
                                Style="{StaticResource FluentWarningButtonStyle}" Margin="0,0,10,0"/>
                        
                        <Button Grid.Column="2" x:Name="ExportDataBtn" Content="ðŸ“¦ Export Data Package" Click="ExportData_Click" 
                                Style="{StaticResource FluentButtonStyle}" Margin="0,0,10,0"/>
                        
                        <Button Grid.Column="3" x:Name="UploadDataBtn" Content="ðŸ“„ Upload Data" Click="UploadData_Click" 
                                Style="{StaticResource FluentSuccessButtonStyle}" Margin="0,0,10,0"/>
                        
                        <Button Grid.Column="4" x:Name="CleanupBtn" Content="ðŸ§¹ Cleanup Old Backups" Click="Cleanup_Click" 
                                Style="{StaticResource FluentDangerButtonStyle}"/>
                        
                        <Button Grid.Column="6" x:Name="RefreshBtn" Content="ðŸ”„ Refresh" Click="Refresh_Click" 
                                Style="{StaticResource FluentSecondaryButtonStyle}"/>
                    </Grid>
                    
                    <!-- Backup History Section -->
                    <Grid Grid.Row="3">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Text="ðŸ“‹ Backup History" Style="{StaticResource SectionHeaderStyle}"/>
                        
                        <DataGrid Grid.Row="1" x:Name="BackupHistoryGrid" AutoGenerateColumns="False" 
                                  CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
                                  Style="{StaticResource ModernDataGridStyle}"
                                  ColumnHeaderStyle="{StaticResource ModernDataGridColumnHeaderStyle}"
                                  CellStyle="{StaticResource ModernDataGridCellStyle}"
                                  RowStyle="{StaticResource ModernDataGridRowStyle}"
                                  VirtualizingPanel.IsVirtualizing="True"
                                  VirtualizingPanel.VirtualizationMode="Recycling">
                            
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ðŸ“… Date Created" Binding="{Binding FormattedDate}" Width="150"/>
                                <DataGridTextColumn Header="âš™ï¸ Operation" Binding="{Binding Operation}" Width="120"/>
                                <DataGridTextColumn Header="ðŸ“„ File Name" Binding="{Binding FileName}" Width="*" MinWidth="200"/>
                                <DataGridTextColumn Header="ðŸ“ Size" Binding="{Binding FormattedSize}" Width="80"/>
                                <DataGridTemplateColumn Header="ðŸ”§ Actions" Width="200">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button Content="ðŸ”„ Restore" Click="RestoreSpecificBackup_Click" 
                                                        Style="{StaticResource FluentWarningButtonStyle}" 
                                                        FontSize="12" MinWidth="80" Padding="8,6" Margin="0,0,5,0"
                                                        Tag="{Binding FilePath}"/>
                                                <Button Content="ðŸ—‘ï¸ Delete" Click="DeleteBackup_Click" 
                                                        Style="{StaticResource FluentDangerButtonStyle}" 
                                                        FontSize="12" MinWidth="70" Padding="8,6" Margin="5,0,0,0"
                                                        Tag="{Binding FilePath}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                        
                        <!-- Empty State -->
                        <TextBlock Grid.Row="1" x:Name="NoBackupsMessage" 
                                   Text="ðŸ“­ No backups found. Create your first backup to get started!" 
                                   HorizontalAlignment="Center" VerticalAlignment="Center" 
                                   FontSize="16" Foreground="{DynamicResource TextTertiaryBrush}" FontStyle="Italic"
                                   Visibility="Collapsed"/>
                    </Grid>
                </Grid>
            </ScrollViewer>
        </TabItem>
        
        <!-- History Tab -->
        <TabItem Header="ðŸ“‹ History">
            <TabControl>
                
                <!-- Purchases Sub-Tab -->
                <TabItem Header="ðŸ’° Purchases">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <!-- Header -->
                        <TextBlock Grid.Row="0" Text="ðŸ’° Purchase History" Style="{StaticResource HeaderTextStyle}"/>
                        
                        <!-- Filter Panel -->
                        <Border Grid.Row="1" Style="{StaticResource InfoCardStyle}" Margin="0,0,0,20">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" Text="ðŸ” Filter Options" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15"/>
                                
                                <Grid Grid.Row="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Date From -->
                                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                        <TextBlock Text="Date From:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                        <DatePicker x:Name="PurchaseDateFromPicker" Width="140" Style="{DynamicResource FluentDatePickerStyle}"/>
                                    </StackPanel>
                                    
                                    <!-- Date To -->
                                    <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                        <TextBlock Text="Date To:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                        <DatePicker x:Name="PurchaseDateToPicker" Width="140" Style="{DynamicResource FluentDatePickerStyle}"/>
                                    </StackPanel>
                                    
                                    <!-- Vessel -->
                                    <StackPanel Grid.Column="2" Margin="0,0,10,0">
                                        <TextBlock Text="Vessel:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                        <ComboBox x:Name="PurchaseVesselFilter" Width="140" DisplayMemberPath="Name" SelectedValuePath="Id" Style="{DynamicResource FluentComboBoxStyle}"/>
                                    </StackPanel>
                                    
                                    <!-- Supplier -->
                                    <StackPanel Grid.Column="3" Margin="0,0,10,0">
                                        <TextBlock Text="Supplier:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                        <ComboBox x:Name="PurchaseSupplierFilter" Width="140" DisplayMemberPath="Name" SelectedValuePath="Id" Style="{DynamicResource FluentComboBoxStyle}"/>
                                    </StackPanel>
                                    
                                    <!-- Invoice Reference -->
                                    <StackPanel Grid.Column="4">
                                        <TextBlock Text="Invoice Reference:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                        <TextBox x:Name="PurchaseInvoiceFilter" Width="140" Style="{DynamicResource FluentTextBoxStyle}"/>
                                    </StackPanel>
                                </Grid>
                                
                                <!-- Filter Buttons -->
                                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
                                    <Button x:Name="ApplyPurchaseFilterBtn" Content="ðŸ” Apply Filter" Click="ApplyPurchaseFilter_Click" 
                                            Style="{StaticResource FluentButtonStyle}" Margin="0,0,10,0"/>
                                    <Button x:Name="ClearPurchaseFilterBtn" Content="ðŸ”„ Clear Filter" Click="ClearPurchaseFilter_Click" 
                                            Style="{StaticResource FluentSecondaryButtonStyle}"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                        <!-- Selection Actions -->
                        <Grid Grid.Row="2" Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock x:Name="PurchaseSelectionCountText" Grid.Column="0" Text="0 of 0 records selected" 
                                       VerticalAlignment="Center" FontWeight="SemiBold" Margin="0,0,20,0"/>
                            
                            <Button Grid.Column="2" x:Name="DeleteSelectedPurchasesBtn" Content="ðŸ—‘ï¸ Delete Selected" 
                                    Click="DeleteSelectedPurchases_Click" Style="{StaticResource FluentDangerButtonStyle}" 
                                    IsEnabled="False" Margin="0,0,10,0"/>
                            
                            <Button Grid.Column="3" x:Name="RefreshPurchasesBtn" Content="ðŸ”„ Refresh" 
                                    Click="RefreshPurchases_Click" Style="{StaticResource FluentSecondaryButtonStyle}"/>
                        </Grid>
                        
                        <!-- Purchase History DataGrid -->
                        <DataGrid Grid.Row="3" x:Name="PurchaseHistoryGrid" AutoGenerateColumns="False" 
                                  CanUserAddRows="False" CanUserDeleteRows="False" 
                                  Style="{StaticResource ModernDataGridStyle}"
                                  ColumnHeaderStyle="{StaticResource ModernDataGridColumnHeaderStyle}"
                                  CellStyle="{StaticResource ModernDataGridCellStyle}"
                                  RowStyle="{StaticResource ModernDataGridRowStyle}"
                                  VirtualizingPanel.IsVirtualizing="True"
                                  VirtualizingPanel.VirtualizationMode="Recycling"
                                  SelectionChanged="PurchaseHistoryGrid_SelectionChanged">
                            
                            <DataGrid.Columns>
                                <!-- Selection Checkbox -->
                                <DataGridTemplateColumn Header="" Width="40">
                                    <DataGridTemplateColumn.HeaderTemplate>
                                        <DataTemplate>
                                            <CheckBox x:Name="SelectAllPurchasesCheckBox" 
                                                      Checked="SelectAllPurchases_Checked" 
                                                      Unchecked="SelectAllPurchases_Unchecked"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.HeaderTemplate>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <CheckBox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" 
                                                      Checked="PurchaseSelection_Changed" 
                                                      Unchecked="PurchaseSelection_Changed"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                
                                <DataGridTextColumn Header="ðŸ“… Date" Binding="{Binding PurchaseDate, StringFormat=dd/MM/yyyy}" Width="100"/>
                                <DataGridTextColumn Header="ðŸš¢ Vessel" Binding="{Binding Vessel.Name}" Width="120"/>
                                <DataGridTextColumn Header="ðŸ­ Supplier" Binding="{Binding Supplier.Name}" Width="120"/>
                                <DataGridTextColumn Header="ðŸ“„ Invoice" Binding="{Binding InvoiceReference}" Width="120"/>
                                <DataGridTextColumn Header="â›½ Liters" Binding="{Binding QuantityLiters, StringFormat=N3}" Width="100"/>
                                <DataGridTextColumn Header="ðŸ‹ï¸ Tons" Binding="{Binding QuantityTons, StringFormat=N3}" Width="100"/>
                                <DataGridTextColumn Header="ðŸ’° Value" Binding="{Binding TotalValueUSD, StringFormat=C2}" Width="100"/>
                                <DataGridTextColumn Header="ðŸ¦ Currency" Binding="{Binding Supplier.Currency}" Width="80"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </TabItem>
                
                <!-- Consumptions Sub-Tab -->
                <TabItem Header="â›½ Consumptions">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <!-- Header -->
                        <TextBlock Grid.Row="0" Text="â›½ Consumption History" Style="{StaticResource HeaderTextStyle}"/>
                        
                        <!-- Filter Panel -->
                        <Border Grid.Row="1" Style="{StaticResource InfoCardStyle}" Margin="0,0,0,20">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" Text="ðŸ” Filter Options" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,15"/>
                                
                                <Grid Grid.Row="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- Month -->
                                    <StackPanel Grid.Column="0" Margin="0,0,20,0">
                                        <TextBlock Text="Month:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                        <DatePicker x:Name="ConsumptionMonthPicker" Width="140" Style="{DynamicResource FluentDatePickerStyle}"/>
                                    </StackPanel>
                                    
                                    <!-- Vessel -->
                                    <StackPanel Grid.Column="1" Margin="0,0,20,0">
                                        <TextBlock Text="Vessel:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                        <ComboBox x:Name="ConsumptionVesselFilter" Width="140" DisplayMemberPath="Name" SelectedValuePath="Id" Style="{DynamicResource FluentComboBoxStyle}"/>
                                    </StackPanel>
                                </Grid>
                                
                                <!-- Filter Buttons -->
                                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
                                    <Button x:Name="ApplyConsumptionFilterBtn" Content="ðŸ” Apply Filter" Click="ApplyConsumptionFilter_Click" 
                                            Style="{StaticResource FluentButtonStyle}" Margin="0,0,10,0"/>
                                    <Button x:Name="ClearConsumptionFilterBtn" Content="ðŸ”„ Clear Filter" Click="ClearConsumptionFilter_Click" 
                                            Style="{StaticResource FluentSecondaryButtonStyle}"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                        <!-- Selection Actions -->
                        <Grid Grid.Row="2" Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock x:Name="ConsumptionSelectionCountText" Grid.Column="0" Text="0 of 0 records selected" 
                                       VerticalAlignment="Center" FontWeight="SemiBold" Margin="0,0,20,0"/>
                            
                            <Button Grid.Column="2" x:Name="DeleteSelectedConsumptionsBtn" Content="ðŸ—‘ï¸ Delete Selected" 
                                    Click="DeleteSelectedConsumptions_Click" Style="{StaticResource FluentDangerButtonStyle}" 
                                    IsEnabled="False" Margin="0,0,10,0"/>
                            
                            <Button Grid.Column="3" x:Name="RefreshConsumptionsBtn" Content="ðŸ”„ Refresh" 
                                    Click="RefreshConsumptions_Click" Style="{StaticResource FluentSecondaryButtonStyle}"/>
                        </Grid>
                        
                        <!-- Consumption History DataGrid -->
                        <DataGrid Grid.Row="3" x:Name="ConsumptionHistoryGrid" AutoGenerateColumns="False" 
                                  CanUserAddRows="False" CanUserDeleteRows="False" 
                                  Style="{StaticResource ModernDataGridStyle}"
                                  ColumnHeaderStyle="{StaticResource ModernDataGridColumnHeaderStyle}"
                                  CellStyle="{StaticResource ModernDataGridCellStyle}"
                                  RowStyle="{StaticResource ModernDataGridRowStyle}"
                                  VirtualizingPanel.IsVirtualizing="True"
                                  VirtualizingPanel.VirtualizationMode="Recycling"
                                  SelectionChanged="ConsumptionHistoryGrid_SelectionChanged">
                            
                            <DataGrid.Columns>
                                <!-- Selection Checkbox -->
                                <DataGridTemplateColumn Header="" Width="40">
                                    <DataGridTemplateColumn.HeaderTemplate>
                                        <DataTemplate>
                                            <CheckBox x:Name="SelectAllConsumptionsCheckBox" 
                                                      Checked="SelectAllConsumptions_Checked" 
                                                      Unchecked="SelectAllConsumptions_Unchecked"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.HeaderTemplate>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <CheckBox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" 
                                                      Checked="ConsumptionSelection_Changed" 
                                                      Unchecked="ConsumptionSelection_Changed"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                
                                <DataGridTextColumn Header="ðŸ“… Date" Binding="{Binding ConsumptionDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                                <DataGridTextColumn Header="ðŸš¢ Vessel" Binding="{Binding Vessel.Name}" Width="150"/>
                                <DataGridTextColumn Header="ðŸ“… Month" Binding="{Binding Month}" Width="100"/>
                                <DataGridTextColumn Header="â›½ Liters" Binding="{Binding ConsumptionLiters, StringFormat=N3}" Width="120"/>
                                <DataGridTextColumn Header="ðŸš¢ Legs" Binding="{Binding LegsCompleted}" Width="80"/>
                                <DataGridTextColumn Header="ðŸ“… Created" Binding="{Binding CreatedDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </TabItem>
                
            </TabControl>
        </TabItem>
    </TabControl>
</UserControl>