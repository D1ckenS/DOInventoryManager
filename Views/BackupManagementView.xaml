<UserControl x:Class="DOInventoryManager.Views.BackupManagementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1200">
    
    <UserControl.Resources>
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#2C3E50"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
        </Style>
        
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#34495E"/>
            <Setter Property="Margin" Value="0,20,0,10"/>
        </Style>
        
        <Style x:Key="ActionButtonStyle" TargetType="Button">
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="MinWidth" Value="140"/>
        </Style>
        
        <Style x:Key="PrimaryButtonStyle" BasedOn="{StaticResource ActionButtonStyle}" TargetType="Button">
            <Setter Property="Background" Value="#3498DB"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#2980B9"/>
        </Style>
        
        <Style x:Key="SuccessButtonStyle" BasedOn="{StaticResource ActionButtonStyle}" TargetType="Button">
            <Setter Property="Background" Value="#27AE60"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#229954"/>
        </Style>
        
        <Style x:Key="WarningButtonStyle" BasedOn="{StaticResource ActionButtonStyle}" TargetType="Button">
            <Setter Property="Background" Value="#F39C12"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#E67E22"/>
        </Style>
        
        <Style x:Key="DangerButtonStyle" BasedOn="{StaticResource ActionButtonStyle}" TargetType="Button">
            <Setter Property="Background" Value="#E74C3C"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#C0392B"/>
        </Style>
        
        <Style x:Key="InfoCardStyle" TargetType="Border">
            <Setter Property="Background" Value="#ECF0F1"/>
            <Setter Property="BorderBrush" Value="#BDC3C7"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
    </UserControl.Resources>
    
    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <!-- Header -->
            <TextBlock Grid.Row="0" Text="🗄️ Backup Management" Style="{StaticResource HeaderTextStyle}"/>
            
            <!-- Current Status Section -->
            <Grid Grid.Row="1" Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- Last Backup Card -->
                <Border Grid.Column="0" Style="{StaticResource InfoCardStyle}">
                    <StackPanel>
                        <TextBlock Text="📅 Last Backup" FontWeight="SemiBold" FontSize="14" Foreground="#7F8C8D"/>
                        <TextBlock x:Name="LastBackupText" Text="Never" FontSize="16" FontWeight="Bold" Foreground="#2C3E50"/>
                        <TextBlock x:Name="LastBackupOperationText" Text="" FontSize="12" Foreground="#7F8C8D"/>
                    </StackPanel>
                </Border>
                
                <!-- Total Backups Card -->
                <Border Grid.Column="1" Style="{StaticResource InfoCardStyle}">
                    <StackPanel>
                        <TextBlock Text="📊 Total Backups" FontWeight="SemiBold" FontSize="14" Foreground="#7F8C8D"/>
                        <TextBlock x:Name="TotalBackupsText" Text="0" FontSize="16" FontWeight="Bold" Foreground="#2C3E50"/>
                        <TextBlock x:Name="TotalBackupSizeText" Text="0 MB" FontSize="12" Foreground="#7F8C8D"/>
                    </StackPanel>
                </Border>
                
                <!-- Database Size Card -->
                <Border Grid.Column="2" Style="{StaticResource InfoCardStyle}">
                    <StackPanel>
                        <TextBlock Text="💽 Database Size" FontWeight="SemiBold" FontSize="14" Foreground="#7F8C8D"/>
                        <TextBlock x:Name="DatabaseSizeText" Text="0 MB" FontSize="16" FontWeight="Bold" Foreground="#2C3E50"/>
                        <TextBlock Text="Current active database" FontSize="12" Foreground="#7F8C8D"/>
                    </StackPanel>
                </Border>
                
                <!-- Backup Folder Card -->
                <Border Grid.Column="3" Style="{StaticResource InfoCardStyle}">
                    <StackPanel>
                        <TextBlock Text="📁 Backup Location" FontWeight="SemiBold" FontSize="14" Foreground="#7F8C8D"/>
                        <Button x:Name="OpenFolderBtn" Content="Open Folder" Click="OpenFolder_Click" 
                                Style="{StaticResource PrimaryButtonStyle}" FontSize="12" MinWidth="100" Padding="8,4"/>
                        <TextBlock x:Name="BackupFolderText" Text="Documents\DO Inventory Backups" FontSize="10" Foreground="#7F8C8D" TextWrapping="Wrap"/>
                    </StackPanel>
                </Border>
            </Grid>
            
            <!-- Action Buttons Section -->
            <Grid Grid.Row="2" Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <Button Grid.Column="0" x:Name="CreateBackupBtn" Content="🗄️ Create Backup" Click="CreateBackup_Click" 
                        Style="{StaticResource SuccessButtonStyle}"/>
                
                <Button Grid.Column="1" x:Name="RestoreBackupBtn" Content="🔄 Restore Backup" Click="RestoreBackup_Click" 
                        Style="{StaticResource WarningButtonStyle}"/>
                
                <Button Grid.Column="2" x:Name="ExportDataBtn" Content="📦 Export Data Package" Click="ExportData_Click" 
                        Style="{StaticResource PrimaryButtonStyle}"/>
                
                <Button Grid.Column="3" x:Name="UploadDataBtn" Content="📄 Upload Data" Click="UploadData_Click" 
                        Style="{StaticResource SuccessButtonStyle}"/>
                
                <Button Grid.Column="4" x:Name="CleanupBtn" Content="🧹 Cleanup Old Backups" Click="Cleanup_Click" 
                        Style="{StaticResource DangerButtonStyle}"/>
                
                <Button Grid.Column="6" x:Name="RefreshBtn" Content="🔄 Refresh" Click="Refresh_Click" 
                        Style="{StaticResource ActionButtonStyle}"/>
            </Grid>
            
            <!-- Backup History Section -->
            <Grid Grid.Row="3">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="📋 Backup History" Style="{StaticResource SectionHeaderStyle}"/>
                
                <DataGrid Grid.Row="1" x:Name="BackupHistoryGrid" AutoGenerateColumns="False" 
                          CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
                          GridLinesVisibility="Horizontal" HeadersVisibility="Column"
                          AlternatingRowBackground="#F8F9FA" RowBackground="White"
                          BorderBrush="#DEE2E6" BorderThickness="1">
                    
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="📅 Date Created" Binding="{Binding FormattedDate}" Width="150"/>
                        <DataGridTextColumn Header="⚙️ Operation" Binding="{Binding Operation}" Width="120"/>
                        <DataGridTextColumn Header="📄 File Name" Binding="{Binding FileName}" Width="*" MinWidth="200"/>
                        <DataGridTextColumn Header="📏 Size" Binding="{Binding FormattedSize}" Width="80"/>
                        <DataGridTemplateColumn Header="🔧 Actions" Width="200">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Button Content="🔄 Restore" Click="RestoreSpecificBackup_Click" 
                                                Style="{StaticResource WarningButtonStyle}" 
                                                FontSize="11" MinWidth="70" Padding="6,3" Margin="2"
                                                Tag="{Binding FilePath}"/>
                                        <Button Content="🗑️ Delete" Click="DeleteBackup_Click" 
                                                Style="{StaticResource DangerButtonStyle}" 
                                                FontSize="11" MinWidth="60" Padding="6,3" Margin="2"
                                                Tag="{Binding FilePath}"/>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
                
                <!-- Empty State -->
                <TextBlock Grid.Row="1" x:Name="NoBackupsMessage" 
                           Text="📭 No backups found. Create your first backup to get started!" 
                           HorizontalAlignment="Center" VerticalAlignment="Center" 
                           FontSize="16" Foreground="#7F8C8D" FontStyle="Italic"
                           Visibility="Collapsed"/>
            </Grid>
        </Grid>
    </ScrollViewer>
</UserControl>