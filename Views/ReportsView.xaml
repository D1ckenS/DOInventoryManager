<UserControl x:Class="DOInventoryManager.Views.ReportsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Header -->
                <RowDefinition Height="*"/>
                <!-- Content -->
            </Grid.RowDefinitions>

            <!-- Header -->
            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                <TextBlock Text="📈" FontSize="32" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBlock Text="Reports &amp; Analytics" FontSize="28" FontWeight="Bold" 
                         VerticalAlignment="Center" Foreground="#2c3e50"/>
            </StackPanel>

            <!-- Reports Tabs -->
            <TabControl Grid.Row="1" x:Name="ReportsTabControl">

                <!-- Monthly Summary Tab -->
                <TabItem Header="📊 Monthly Summary">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <Grid Margin="20">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <!-- Controls -->
                                <RowDefinition Height="*"/>
                                <!-- Content -->
                            </Grid.RowDefinitions>

                            <!-- Controls -->
                            <Border Grid.Row="0" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" 
                                  CornerRadius="8" Padding="20" Margin="0,0,0,20">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                                        <TextBlock Text="Select Month:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                        <ComboBox x:Name="MonthComboBox" MinWidth="120" Padding="10,8" 
                                                SelectionChanged="MonthComboBox_SelectionChanged"/>
                                        <Button x:Name="GenerateBtn" Content="📊 Generate Report" 
                                              Background="#007bff" Foreground="White" BorderThickness="0" 
                                              Padding="15,10" Margin="15,0,0,0" FontWeight="SemiBold"
                                              Click="Generate_Click"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                                        <Button x:Name="ExportBtn" Content="📤 Export to Excel" 
                                              Background="#28a745" Foreground="White" BorderThickness="0" 
                                              Padding="15,10" Margin="0,0,10,0" FontWeight="SemiBold"
                                              Click="Export_Click"/>
                                        <Button x:Name="PrintBtn" Content="🖨️ Print Report" 
                                              Background="#6c757d" Foreground="White" BorderThickness="0" 
                                              Padding="15,10" FontWeight="SemiBold"
                                              Click="Print_Click"/>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- Summary Content (will be populated from existing SummaryView) -->
                            <TabControl Grid.Row="1" x:Name="SummaryTabControl">
                                <!-- Executive Summary -->
                                <TabItem Header="📊 Executive Summary">
                                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                                        <StackPanel Margin="20">
                                            <!-- KPI Cards -->
                                            <Grid Margin="0,0,0,30">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <Border Grid.Column="0" Background="#007bff" CornerRadius="8" Margin="0,0,15,0" Padding="20">
                                                    <StackPanel>
                                                        <TextBlock Text="⛽" FontSize="24" HorizontalAlignment="Center" Foreground="White"/>
                                                        <TextBlock x:Name="TotalConsumptionText" Text="0 L" FontSize="18" FontWeight="Bold" 
                                                                 HorizontalAlignment="Center" Foreground="White" Margin="0,5,0,3"/>
                                                        <TextBlock Text="Total Consumption" FontSize="11" HorizontalAlignment="Center" 
                                                                 Foreground="LightBlue"/>
                                                    </StackPanel>
                                                </Border>

                                                <Border Grid.Column="1" Background="#28a745" CornerRadius="8" Margin="0,0,15,0" Padding="20">
                                                    <StackPanel>
                                                        <TextBlock Text="🗺️" FontSize="24" HorizontalAlignment="Center" Foreground="White"/>
                                                        <TextBlock x:Name="TotalLegsText" Text="0" FontSize="18" FontWeight="Bold" 
                                                                 HorizontalAlignment="Center" Foreground="White" Margin="0,5,0,3"/>
                                                        <TextBlock Text="Legs Completed" FontSize="11" HorizontalAlignment="Center" 
                                                                 Foreground="LightGreen"/>
                                                    </StackPanel>
                                                </Border>

                                                <Border Grid.Column="2" Background="#dc3545" CornerRadius="8" Margin="0,0,15,0" Padding="20">
                                                    <StackPanel>
                                                        <TextBlock Text="💰" FontSize="24" HorizontalAlignment="Center" Foreground="White"/>
                                                        <TextBlock x:Name="TotalCostText" Text="$0" FontSize="18" FontWeight="Bold" 
                                                                 HorizontalAlignment="Center" Foreground="White" Margin="0,5,0,3"/>
                                                        <TextBlock Text="Operating Cost" FontSize="11" HorizontalAlignment="Center" 
                                                                 Foreground="LightPink"/>
                                                    </StackPanel>
                                                </Border>

                                                <Border Grid.Column="3" Background="#ffc107" CornerRadius="8" Padding="20">
                                                    <StackPanel>
                                                        <TextBlock Text="📈" FontSize="24" HorizontalAlignment="Center" Foreground="White"/>
                                                        <TextBlock x:Name="EfficiencyText" Text="0 L/leg" FontSize="18" FontWeight="Bold" 
                                                                 HorizontalAlignment="Center" Foreground="White" Margin="0,5,0,3"/>
                                                        <TextBlock Text="Fleet Efficiency" FontSize="11" HorizontalAlignment="Center" 
                                                                 Foreground="#856404"/>
                                                    </StackPanel>
                                                </Border>
                                            </Grid>

                                            <!-- Executive Metrics -->
                                            <Border Background="White" BorderBrush="#dee2e6" BorderThickness="1" 
                                                  CornerRadius="6" Padding="20">
                                                <StackPanel>
                                                    <TextBlock Text="📋 Executive Metrics" FontSize="16" FontWeight="SemiBold" 
                                                             Margin="0,0,0,15" Foreground="#2c3e50"/>

                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>

                                                        <StackPanel Grid.Column="0">
                                                            <TextBlock x:Name="VesselsOperatedText" Text="Vessels Operated: 0" FontSize="14" Margin="0,5"/>
                                                            <TextBlock x:Name="SuppliersUsedText" Text="Suppliers Used: 0" FontSize="14" Margin="0,5"/>
                                                            <TextBlock x:Name="CostPerLegText" Text="Cost per Leg: $0.00" FontSize="14" Margin="0,5"/>
                                                        </StackPanel>

                                                        <StackPanel Grid.Column="1">
                                                            <TextBlock x:Name="FleetEfficiencyLText" Text="Fleet Efficiency (L): 0.000 L/leg" FontSize="14" Margin="0,5"/>
                                                            <TextBlock x:Name="FleetEfficiencyTText" Text="Fleet Efficiency (T): 0.000 T/leg" FontSize="14" Margin="0,5"/>
                                                            <TextBlock x:Name="InventoryTurnoverText" Text="Inventory Turnover: 0.00" FontSize="14" Margin="0,5"/>
                                                        </StackPanel>
                                                    </Grid>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </ScrollViewer>
                                </TabItem>

                                <!-- Consumption Summary Tab -->
                                <TabItem Header="⛽ Consumption Summary">
                                    <StackPanel Margin="20">
                                        <TextBlock Text="Vessel Consumption Analysis" FontSize="16" FontWeight="SemiBold" 
                                                Margin="0,0,0,15" Foreground="#2c3e50"/>

                                        <DataGrid x:Name="ConsumptionSummaryGrid" 
                                                AutoGenerateColumns="False" 
                                                CanUserAddRows="False"
                                                CanUserDeleteRows="False"
                                                GridLinesVisibility="Horizontal"
                                                HeadersVisibility="Column"
                                                Background="White"
                                                BorderThickness="1"
                                                BorderBrush="#dee2e6">

                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Vessel" Binding="{Binding VesselName}" Width="120"/>
                                                <DataGridTextColumn Header="Type" Binding="{Binding VesselType}" Width="80"/>
                                                <DataGridTextColumn Header="Route" Binding="{Binding Route}" Width="180"/>
                                                <DataGridTextColumn Header="Consumption (L)" Binding="{Binding TotalConsumptionL, StringFormat=N3}" Width="120"/>
                                                <DataGridTextColumn Header="Consumption (T)" Binding="{Binding TotalConsumptionT, StringFormat=N3}" Width="120"/>
                                                <DataGridTextColumn Header="Total Legs" Binding="{Binding TotalLegs}" Width="80"/>
                                                <DataGridTextColumn Header="L/Leg" Binding="{Binding AvgConsumptionPerLegL, StringFormat=N3}" Width="80"/>
                                                <DataGridTextColumn Header="T/Leg" Binding="{Binding AvgConsumptionPerLegT, StringFormat=N3}" Width="80"/>
                                                <DataGridTextColumn Header="Total Cost" Binding="{Binding TotalAllocatedValueUSD, StringFormat=C2}" Width="100"/>
                                                <DataGridTextColumn Header="Cost/L" Binding="{Binding CostPerLiter, StringFormat=C6}" Width="100"/>
                                                <DataGridTextColumn Header="Cost/T" Binding="{Binding CostPerTon, StringFormat=C2}" Width="100"/>
                                                <DataGridTextColumn Header="Entries" Binding="{Binding ConsumptionEntries}" Width="70"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </StackPanel>
                                </TabItem>

                                <!-- Purchase Summary Tab -->
                                <TabItem Header="🛒 Purchase Summary">
                                    <StackPanel Margin="20">
                                        <TextBlock Text="Supplier Purchase Analysis" FontSize="16" FontWeight="SemiBold" 
                                                Margin="0,0,0,15" Foreground="#2c3e50"/>

                                        <DataGrid x:Name="PurchaseSummaryGrid" 
                                                AutoGenerateColumns="False" 
                                                CanUserAddRows="False"
                                                CanUserDeleteRows="False"
                                                GridLinesVisibility="Horizontal"
                                                HeadersVisibility="Column"
                                                Background="White"
                                                BorderThickness="1"
                                                BorderBrush="#dee2e6">

                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Supplier" Binding="{Binding SupplierName}" Width="120"/>
                                                <DataGridTextColumn Header="Currency" Binding="{Binding Currency}" Width="80"/>
                                                <DataGridTextColumn Header="Purchases (L)" Binding="{Binding TotalPurchasesL, StringFormat=N3}" Width="110"/>
                                                <DataGridTextColumn Header="Purchases (T)" Binding="{Binding TotalPurchasesT, StringFormat=N3}" Width="110"/>
                                                <DataGridTextColumn Header="Total Value" Width="120">
                                                    <DataGridTextColumn.Binding>
                                                        <MultiBinding StringFormat="{}{0:N3} {1}">
                                                            <Binding Path="TotalValueOriginal"/>
                                                            <Binding Path="Currency"/>
                                                        </MultiBinding>
                                                    </DataGridTextColumn.Binding>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="USD Value" Binding="{Binding TotalValueUSD, StringFormat=C2}" Width="100"/>
                                                <DataGridTextColumn Header="Avg Price/L" Width="100">
                                                    <DataGridTextColumn.Binding>
                                                        <MultiBinding StringFormat="{}{0:N6} {1}">
                                                            <Binding Path="AvgPricePerLiter"/>
                                                            <Binding Path="Currency"/>
                                                        </MultiBinding>
                                                    </DataGridTextColumn.Binding>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="Remaining (L)" Binding="{Binding RemainingL, StringFormat=N3}" Width="100"/>
                                                <DataGridTextColumn Header="Remaining (T)" Binding="{Binding RemainingT, StringFormat=N3}" Width="100"/>
                                                <DataGridTextColumn Header="Orders" Binding="{Binding PurchaseCount}" Width="70"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </StackPanel>
                                </TabItem>

                                <!-- Allocation Summary Tab -->
                                <TabItem Header="📋 FIFO Allocation">
                                    <StackPanel Margin="20">
                                        <TextBlock Text="FIFO Allocation Analysis" FontSize="16" FontWeight="SemiBold" 
                                                Margin="0,0,0,15" Foreground="#2c3e50"/>

                                        <DataGrid x:Name="AllocationSummaryGrid" 
                                                AutoGenerateColumns="False" 
                                                CanUserAddRows="False"
                                                CanUserDeleteRows="False"
                                                GridLinesVisibility="Horizontal"
                                                HeadersVisibility="Column"
                                                Background="White"
                                                BorderThickness="1"
                                                BorderBrush="#dee2e6">

                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Vessel" Binding="{Binding VesselName}" Width="120"/>
                                                <DataGridTextColumn Header="Supplier" Binding="{Binding SupplierName}" Width="120"/>
                                                <DataGridTextColumn Header="Allocated (L)" Binding="{Binding AllocatedQuantityL, StringFormat=N3}" Width="110"/>
                                                <DataGridTextColumn Header="Allocated (T)" Binding="{Binding AllocatedQuantityT, StringFormat=N3}" Width="110"/>
                                                <DataGridTextColumn Header="USD Value" Binding="{Binding AllocatedValueUSD, StringFormat=C2}" Width="100"/>
                                                <DataGridTextColumn Header="Allocations" Binding="{Binding AllocationCount}" Width="90"/>
                                                <DataGridTextColumn Header="From Date" Binding="{Binding OldestPurchaseDate, StringFormat=dd/MM/yyyy}" Width="100"/>
                                                <DataGridTextColumn Header="To Date" Binding="{Binding NewestPurchaseDate, StringFormat=dd/MM/yyyy}" Width="100"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </StackPanel>
                                </TabItem>

                                <!-- Financial Summary Tab -->
                                <TabItem Header="💰 Financial Summary">
                                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                                        <StackPanel Margin="20">
                                            <!-- Financial Overview -->
                                            <Border Background="White" BorderBrush="#dee2e6" BorderThickness="1" 
                                                    CornerRadius="6" Padding="20" Margin="0,0,0,20">
                                                <StackPanel>
                                                    <TextBlock Text="💰 Financial Overview" FontSize="16" FontWeight="SemiBold" 
                                                            Margin="0,0,0,15" Foreground="#2c3e50"/>

                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>

                                                        <StackPanel Grid.Column="0">
                                                            <TextBlock x:Name="TotalPurchaseValueText" Text="Total Purchases: $0.00" FontSize="14" Margin="0,5"/>
                                                            <TextBlock x:Name="TotalConsumptionValueText" Text="Total Consumption: $0.00" FontSize="14" Margin="0,5"/>
                                                            <TextBlock x:Name="RemainingInventoryText" Text="Remaining Inventory: $0.00" FontSize="14" Margin="0,5"/>
                                                        </StackPanel>

                                                        <StackPanel Grid.Column="1">
                                                            <TextBlock x:Name="AvgCostPerLiterText" Text="Avg Cost/L: $0.000000" FontSize="14" Margin="0,5"/>
                                                            <TextBlock x:Name="AvgCostPerTonText" Text="Avg Cost/T: $0.00" FontSize="14" Margin="0,5"/>
                                                        </StackPanel>
                                                    </Grid>
                                                </StackPanel>
                                            </Border>

                                            <!-- Currency Breakdown -->
                                            <Border Background="White" BorderBrush="#dee2e6" BorderThickness="1" 
                                                    CornerRadius="6" Padding="20" Margin="0,0,0,20">
                                                <StackPanel>
                                                    <TextBlock Text="💱 Currency Breakdown" FontSize="16" FontWeight="SemiBold" 
                                                            Margin="0,0,0,15" Foreground="#2c3e50"/>

                                                    <DataGrid x:Name="CurrencyBreakdownGrid" 
                                                            AutoGenerateColumns="False" 
                                                            CanUserAddRows="False"
                                                            CanUserDeleteRows="False"
                                                            GridLinesVisibility="Horizontal"
                                                            HeadersVisibility="Column"
                                                            Background="White"
                                                            BorderThickness="0">

                                                        <DataGrid.Columns>
                                                            <DataGridTextColumn Header="Currency" Binding="{Binding Currency}" Width="100"/>
                                                            <DataGridTextColumn Header="Total Value" Binding="{Binding TotalValue, StringFormat=N3}" Width="150"/>
                                                            <DataGridTextColumn Header="USD Value" Binding="{Binding TotalValueUSD, StringFormat=C2}" Width="150"/>
                                                            <DataGridTextColumn Header="Exchange Rate" Binding="{Binding ExchangeRate, StringFormat=N6}" Width="150"/>
                                                        </DataGrid.Columns>
                                                    </DataGrid>
                                                </StackPanel>
                                            </Border>

                                            <!-- Payment Status -->
                                            <Border Background="White" BorderBrush="#dee2e6" BorderThickness="1" 
                                                    CornerRadius="6" Padding="20">
                                                <StackPanel>
                                                    <TextBlock Text="📋 Payment Status" FontSize="16" FontWeight="SemiBold" 
                                                            Margin="0,0,0,15" Foreground="#2c3e50"/>

                                                    <DataGrid x:Name="PaymentStatusGrid" 
                                                            AutoGenerateColumns="False" 
                                                            CanUserAddRows="False"
                                                            CanUserDeleteRows="False"
                                                            GridLinesVisibility="Horizontal"
                                                            HeadersVisibility="Column"
                                                            Background="White"
                                                            BorderThickness="0">

                                                        <DataGrid.Columns>
                                                            <DataGridTextColumn Header="Supplier" Binding="{Binding SupplierName}" Width="150"/>
                                                            <DataGridTextColumn Header="Total Due" Binding="{Binding TotalDue, StringFormat=C2}" Width="120"/>
                                                            <DataGridTextColumn Header="Overdue" Binding="{Binding TotalOverdue, StringFormat=C2}" Width="120"/>
                                                            <DataGridTextColumn Header="Overdue Count" Binding="{Binding OverdueCount}" Width="120"/>
                                                            <DataGridTextColumn Header="Total Invoices" Binding="{Binding TotalInvoices}" Width="120"/>
                                                        </DataGrid.Columns>
                                                    </DataGrid>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </ScrollViewer>
                                </TabItem>

                                <!-- Other Summary tabs will be added here -->
                            </TabControl>
                        </Grid>
                    </ScrollViewer>
                </TabItem>

                <!-- Vessel Account Statement Tab -->
                <TabItem Header="🚢 Vessel Account Statement">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <!-- Controls -->
                            <RowDefinition Height="Auto"/>
                            <!-- Summary -->
                            <RowDefinition Height="*"/>
                            <!-- Statement -->
                        </Grid.RowDefinitions>

                        <!-- Controls -->
                        <Border Grid.Row="0" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" 
                              CornerRadius="8" Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Orientation="Horizontal">
                                    <TextBlock Text="Vessel:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <ComboBox x:Name="VesselAccountComboBox" MinWidth="150" Padding="10,8" 
                                            DisplayMemberPath="Name" SelectedValuePath="Id" Margin="0,0,20,0"/>

                                    <TextBlock Text="From:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <DatePicker x:Name="VesselFromDatePicker" Padding="10,8" BorderBrush="#ced4da" 
                                              BorderThickness="1" Margin="0,0,15,0"/>

                                    <TextBlock Text="To:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <DatePicker x:Name="VesselToDatePicker" Padding="10,8" BorderBrush="#ced4da" 
                                              BorderThickness="1" Margin="0,0,15,0"/>

                                    <Button x:Name="GenerateVesselAccountBtn" Content="📊 Generate Statement" 
                                          Background="#007bff" Foreground="White" BorderThickness="0" 
                                          Padding="15,10" FontWeight="SemiBold"
                                          Click="GenerateVesselAccount_Click"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <Button x:Name="ExportVesselBtn" Content="📤 Export" 
                                          Background="#28a745" Foreground="White" BorderThickness="0" 
                                          Padding="15,10" FontWeight="SemiBold"
                                          Click="ExportVessel_Click"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Vessel Summary -->
                        <Border Grid.Row="1" Background="#e8f5e8" BorderBrush="#4caf50" BorderThickness="1" 
                              CornerRadius="8" Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                    <TextBlock Text="🚢 Vessel" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="VesselNameText" Text="Not Selected" FontSize="16" FontWeight="Bold" 
                                             HorizontalAlignment="Center" Foreground="#2e7d32"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                    <TextBlock Text="⛽ Total Purchases" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="VesselTotalPurchasesText" Text="0.000 L" FontSize="16" FontWeight="Bold" 
                                             HorizontalAlignment="Center" Foreground="#2e7d32"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                    <TextBlock Text="🔥 Total Consumption" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="VesselTotalConsumptionText" Text="0.000 L" FontSize="16" FontWeight="Bold" 
                                             HorizontalAlignment="Center" Foreground="#2e7d32"/>
                                </StackPanel>

                                <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                    <TextBlock Text="📦 Current Balance" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="VesselCurrentBalanceText" Text="0.000 L" FontSize="16" FontWeight="Bold" 
                                             HorizontalAlignment="Center" Foreground="#2e7d32"/>
                                </StackPanel>

                                <StackPanel Grid.Column="4" HorizontalAlignment="Center">
                                    <TextBlock Text="💰 Total Value" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="VesselTotalValueText" Text="$0.00" FontSize="16" FontWeight="Bold" 
                                             HorizontalAlignment="Center" Foreground="#2e7d32"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Account Statement -->
                        <Border Grid.Row="2" Background="White" BorderBrush="#dee2e6" BorderThickness="1" 
                              CornerRadius="6" Padding="20">
                            <StackPanel>
                                <TextBlock Text="📋 Vessel Account Statement" FontSize="16" FontWeight="SemiBold" 
                                         Margin="0,0,0,15" Foreground="#2c3e50"/>

                                <DataGrid x:Name="VesselAccountGrid" 
                                        AutoGenerateColumns="False" 
                                        CanUserAddRows="False"
                                        CanUserDeleteRows="False"
                                        GridLinesVisibility="Horizontal"
                                        HeadersVisibility="Column"
                                        Background="White"
                                        BorderThickness="0"
                                        MaxHeight="500">

                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Date" Binding="{Binding TransactionDate, StringFormat=dd/MM/yyyy}" Width="100"/>
                                        <DataGridTextColumn Header="Type" Binding="{Binding TransactionType}" Width="100"/>
                                        <DataGridTextColumn Header="Reference" Binding="{Binding Reference}" Width="120"/>
                                        <DataGridTextColumn Header="Supplier" Binding="{Binding SupplierName}" Width="120"/>
                                        <DataGridTextColumn Header="Debit (L)" Binding="{Binding DebitQuantity, StringFormat=N3}" Width="100"/>
                                        <DataGridTextColumn Header="Credit (L)" Binding="{Binding CreditQuantity, StringFormat=N3}" Width="100"/>
                                        <DataGridTextColumn Header="Balance (L)" Binding="{Binding FormattedRunningBalance}" Width="100"/>
                                        <DataGridTextColumn Header="Value (USD)" Binding="{Binding FormattedValueUSD}" Width="100"/>
                                        <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*"/>
                                    </DataGrid.Columns>
                                </DataGrid>

                                <!-- Vessel Account Totals -->
                                <Grid Margin="0,15,0,0" Background="#f8f9fa">
                                    <Border BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="4" 
                                            Background="#f8f9fa" Margin="1,0,0,0">
                                        <Grid Margin="6,15,0,15">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="100"/>  <!-- Date -->
                                                <ColumnDefinition Width="100"/>  <!-- Type -->
                                                <ColumnDefinition Width="120"/>  <!-- Reference -->
                                                <ColumnDefinition Width="120"/>  <!-- Supplier -->
                                                <ColumnDefinition Width="100"/>  <!-- Debit (L) -->
                                                <ColumnDefinition Width="100"/>  <!-- Credit (L) -->
                                                <ColumnDefinition Width="100"/>  <!-- Balance (L) -->
                                                <ColumnDefinition Width="100"/>  <!-- Value (USD) -->
                                                <ColumnDefinition Width="*"/>    <!-- Description -->
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Column="0" Text="" FontWeight="Bold"/>
                                            <TextBlock Grid.Column="1" Text="" FontWeight="Bold"/>
                                            <TextBlock Grid.Column="2" Text="" FontWeight="Bold"/>
                                            <TextBlock Grid.Column="3" Text="TOTALS:" FontWeight="Bold" 
                                                    HorizontalAlignment="Right" Foreground="#2c3e50"/>
                                            <TextBlock Grid.Column="4" x:Name="VesselTotalDebitsText" Text="0.000" 
                                                    FontWeight="Bold" HorizontalAlignment="Center" Foreground="#2c3e50"/>
                                            <TextBlock Grid.Column="5" x:Name="VesselTotalCreditsText" Text="0.000" 
                                                    FontWeight="Bold" HorizontalAlignment="Center" Foreground="#2c3e50"/>
                                            <TextBlock Grid.Column="6" x:Name="VesselNetBalanceText" Text="0.000" 
                                                    FontWeight="Bold" HorizontalAlignment="Center" Foreground="#2c3e50"/>
                                            <TextBlock Grid.Column="7" x:Name="VesselAccountTotalValueText" Text="$0.00" 
                                                    FontWeight="Bold" HorizontalAlignment="Center" Foreground="#2c3e50"/>
                                            <TextBlock Grid.Column="8" Text="" FontWeight="Bold"/>
                                        </Grid>
                                    </Border>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Grid>
                </TabItem>

                <!-- Supplier Account Report Tab -->
                <TabItem Header="🏢 Supplier Account Report">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <!-- Controls -->
                            <RowDefinition Height="Auto"/>
                            <!-- Summary -->
                            <RowDefinition Height="*"/>
                            <!-- Report -->
                        </Grid.RowDefinitions>

                        <!-- Controls -->
                        <Border Grid.Row="0" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" 
                              CornerRadius="8" Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Orientation="Horizontal">
                                    <TextBlock Text="Supplier:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <ComboBox x:Name="SupplierAccountComboBox" MinWidth="150" Padding="10,8" 
                                            DisplayMemberPath="Name" SelectedValuePath="Id" Margin="0,0,20,0"/>

                                    <TextBlock Text="From:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <DatePicker x:Name="SupplierFromDatePicker" Padding="10,8" BorderBrush="#ced4da" 
                                              BorderThickness="1" Margin="0,0,15,0"/>

                                    <TextBlock Text="To:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <DatePicker x:Name="SupplierToDatePicker" Padding="10,8" BorderBrush="#ced4da" 
                                              BorderThickness="1" Margin="0,0,15,0"/>

                                    <Button x:Name="GenerateSupplierAccountBtn" Content="📊 Generate Report" 
                                          Background="#007bff" Foreground="White" BorderThickness="0" 
                                          Padding="15,10" FontWeight="SemiBold"
                                          Click="GenerateSupplierAccount_Click"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <Button x:Name="ExportSupplierBtn" Content="📤 Export" 
                                          Background="#28a745" Foreground="White" BorderThickness="0" 
                                          Padding="15,10" FontWeight="SemiBold"
                                          Click="ExportSupplier_Click"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Supplier Summary -->
                        <Border Grid.Row="1" Background="#fff3cd" BorderBrush="#ffc107" BorderThickness="1" 
                              CornerRadius="8" Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                    <TextBlock Text="🏢 Supplier" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="SupplierNameText" Text="Not Selected" FontSize="16" FontWeight="Bold" 
                                             HorizontalAlignment="Center" Foreground="#856404"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                    <TextBlock Text="📦 Beginning Balance" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="SupplierBeginningBalanceText" Text="0.000 L" FontSize="16" FontWeight="Bold" 
                                             HorizontalAlignment="Center" Foreground="#856404"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                    <TextBlock Text="⛽ Period Purchases" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="SupplierPeriodPurchasesText" Text="0.000 L" FontSize="16" FontWeight="Bold" 
                                             HorizontalAlignment="Center" Foreground="#856404"/>
                                </StackPanel>

                                <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                    <TextBlock Text="🔥 Period Consumption" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="SupplierPeriodConsumptionText" Text="0.000 L" FontSize="16" FontWeight="Bold" 
                                             HorizontalAlignment="Center" Foreground="#856404"/>
                                </StackPanel>

                                <StackPanel Grid.Column="4" HorizontalAlignment="Center">
                                    <TextBlock Text="📊 Ending Balance" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="SupplierEndingBalanceText" Text="0.000 L" FontSize="16" FontWeight="Bold" 
                                             HorizontalAlignment="Center" Foreground="#856404"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Supplier Report -->
                        <Border Grid.Row="2" Background="White" BorderBrush="#dee2e6" BorderThickness="1" 
                              CornerRadius="6" Padding="20">
                            <StackPanel>
                                <TextBlock Text="📋 Supplier Account Report" FontSize="16" FontWeight="SemiBold" 
                                         Margin="0,0,0,15" Foreground="#2c3e50"/>

                                <DataGrid x:Name="SupplierAccountGrid" 
                                        AutoGenerateColumns="False" 
                                        CanUserAddRows="False"
                                        CanUserDeleteRows="False"
                                        GridLinesVisibility="Horizontal"
                                        HeadersVisibility="Column"
                                        Background="White"
                                        BorderThickness="0"
                                        MaxHeight="500">

                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Date" Binding="{Binding TransactionDate, StringFormat=dd/MM/yyyy}" Width="100"/>
                                        <DataGridTextColumn Header="Vessel" Binding="{Binding VesselName}" Width="120"/>
                                        <DataGridTextColumn Header="Type" Binding="{Binding TransactionType}" Width="100"/>
                                        <DataGridTextColumn Header="Reference" Binding="{Binding Reference}" Width="120"/>
                                        <DataGridTextColumn Header="Purchases (L)" Binding="{Binding PurchaseQuantity, StringFormat=N3}" Width="120"/>
                                        <DataGridTextColumn Header="Consumption (L)" Binding="{Binding ConsumptionQuantity, StringFormat=N3}" Width="120"/>
                                        <DataGridTextColumn Header="Value" Binding="{Binding FormattedValue}" Width="120"/>
                                        <DataGridTextColumn Header="USD Value" Binding="{Binding FormattedValueUSD}" Width="100"/>
                                        <DataGridTextColumn Header="Balance (L)" Binding="{Binding RunningBalance, StringFormat=N3}" Width="100"/>
                                    </DataGrid.Columns>
                                </DataGrid>

                                <!-- Supplier Account Totals -->
                                <Grid Margin="0,15,0,0" Background="#fff3cd">
                                    <Border BorderBrush="#ffc107" BorderThickness="1" CornerRadius="4" 
                                            Background="#fff3cd" Margin="1,0,0,0">
                                        <Grid Margin="6,15,0,15">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="100"/>  <!-- Date -->
                                                <ColumnDefinition Width="120"/>  <!-- Vessel -->
                                                <ColumnDefinition Width="100"/>  <!-- Type -->
                                                <ColumnDefinition Width="120"/>  <!-- Reference -->
                                                <ColumnDefinition Width="120"/>  <!-- Purchases (L) -->
                                                <ColumnDefinition Width="120"/>  <!-- Consumption (L) -->
                                                <ColumnDefinition Width="120"/>  <!-- Value -->
                                                <ColumnDefinition Width="100"/>  <!-- USD Value -->
                                                <ColumnDefinition Width="100"/>  <!-- Balance (L) -->
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Column="0" Text="" FontWeight="Bold"/>
                                            <TextBlock Grid.Column="1" Text="" FontWeight="Bold"/>
                                            <TextBlock Grid.Column="2" Text="" FontWeight="Bold"/>
                                            <TextBlock Grid.Column="3" Text="TOTALS:" FontWeight="Bold" 
                                                    HorizontalAlignment="Right" Foreground="#856404"/>
                                            <TextBlock Grid.Column="4" x:Name="SupplierTotalPurchasesText" Text="0.000" 
                                                    FontWeight="Bold" HorizontalAlignment="Center" Foreground="#856404"/>
                                            <TextBlock Grid.Column="5" x:Name="SupplierTotalConsumptionText" Text="0.000" 
                                                    FontWeight="Bold" HorizontalAlignment="Center" Foreground="#856404"/>
                                            <TextBlock Grid.Column="6" x:Name="SupplierAccountTotalValueText" Text="0.000 USD" 
                                                    FontWeight="Bold" HorizontalAlignment="Center" Foreground="#856404"/>
                                            <TextBlock Grid.Column="7" x:Name="SupplierAccountTotalUSDText" Text="$0.00" 
                                                    FontWeight="Bold" HorizontalAlignment="Center" Foreground="#856404"/>
                                            <TextBlock Grid.Column="8" x:Name="SupplierNetBalanceText" Text="0.000" 
                                                    FontWeight="Bold" HorizontalAlignment="Center" Foreground="#856404"/>
                                        </Grid>
                                    </Border>
                                </Grid>
                                
                            </StackPanel>
                        </Border>
                    </Grid>
                </TabItem>

                <!-- Payment Due Report Tab -->
                <TabItem Header="💳 Payment Due Report">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <!-- Controls -->
                            <RowDefinition Height="Auto"/>
                            <!-- Summary -->
                            <RowDefinition Height="*"/>
                            <!-- Report -->
                        </Grid.RowDefinitions>

                        <!-- Controls -->
                        <Border Grid.Row="0" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" 
                            CornerRadius="8" Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Orientation="Horizontal">
                                    <Button x:Name="GeneratePaymentReportBtn" Content="📊 Generate Payment Report" 
                                        Background="#007bff" Foreground="White" BorderThickness="0" 
                                        Padding="15,10" FontWeight="SemiBold"
                                        Click="GeneratePaymentReport_Click"/>
                                    
                                    <TextBlock Text="Real-time payment status and aging analysis" 
                                            VerticalAlignment="Center" Margin="20,0,0,0" 
                                            FontStyle="Italic" Foreground="Gray"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <Button x:Name="ExportPaymentBtn" Content="📤 Export" 
                                        Background="#28a745" Foreground="White" BorderThickness="0" 
                                        Padding="15,10" FontWeight="SemiBold"
                                        Click="ExportPayment_Click"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Payment Summary Cards -->
                        <Border Grid.Row="1" Background="#fff" BorderBrush="#dee2e6" BorderThickness="1" 
                                CornerRadius="8" Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                    <TextBlock Text="▲ Overdue" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12" Foreground="#dc3545"/>
                                    <TextBlock x:Name="OverdueAmountText" Text="$0.00" FontSize="16" FontWeight="Bold" 
                                            HorizontalAlignment="Center" Foreground="#dc3545"/>
                                    <TextBlock x:Name="OverdueCountText" Text="0 invoices" FontSize="10" 
                                            HorizontalAlignment="Center" Foreground="#dc3545"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                    <TextBlock Text="⚠ Due Today" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12" Foreground="#fd7e14"/>
                                    <TextBlock x:Name="DueTodayAmountText" Text="$0.00" FontSize="16" FontWeight="Bold" 
                                            HorizontalAlignment="Center" Foreground="#fd7e14"/>
                                    <TextBlock x:Name="DueTodayCountText" Text="0 invoices" FontSize="10" 
                                            HorizontalAlignment="Center" Foreground="#fd7e14"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                    <TextBlock Text="⏰ This Week" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12" Foreground="#ffc107"/>
                                    <TextBlock x:Name="DueThisWeekAmountText" Text="$0.00" FontSize="16" FontWeight="Bold" 
                                            HorizontalAlignment="Center" Foreground="#ffc107"/>
                                    <TextBlock x:Name="DueThisWeekCountText" Text="0 invoices" FontSize="10" 
                                            HorizontalAlignment="Center" Foreground="#ffc107"/>
                                </StackPanel>

                                <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                    <TextBlock Text="→ Next Week" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12" Foreground="#28a745"/>
                                    <TextBlock x:Name="DueNextWeekAmountText" Text="$0.00" FontSize="16" FontWeight="Bold" 
                                            HorizontalAlignment="Center" Foreground="#28a745"/>
                                    <TextBlock x:Name="DueNextWeekCountText" Text="0 invoices" FontSize="10" 
                                            HorizontalAlignment="Center" Foreground="#28a745"/>
                                </StackPanel>

                                <StackPanel Grid.Column="4" HorizontalAlignment="Center">
                                    <TextBlock Text="📊 Total Outstanding" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12" Foreground="#6c757d"/>
                                    <TextBlock x:Name="TotalOutstandingAmountText" Text="$0.00" FontSize="16" FontWeight="Bold" 
                                            HorizontalAlignment="Center" Foreground="#6c757d"/>
                                    <TextBlock x:Name="TotalOutstandingCountText" Text="0 invoices" FontSize="10" 
                                            HorizontalAlignment="Center" Foreground="#6c757d"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Payment Report Tabs -->
                        <TabControl Grid.Row="2" x:Name="PaymentTabControl">

                            <!-- Payment Schedule Tab -->
                            <TabItem Header="📅 Payment Schedule">
                                <StackPanel Margin="20">
                                    <TextBlock Text="All Outstanding Invoices by Due Date" FontSize="16" FontWeight="SemiBold" 
                                            Margin="0,0,0,15" Foreground="#2c3e50"/>

                                    <DataGrid x:Name="PaymentScheduleGrid" 
                                            AutoGenerateColumns="False" 
                                            CanUserAddRows="False"
                                            CanUserDeleteRows="False"
                                            GridLinesVisibility="Horizontal"
                                            HeadersVisibility="Column"
                                            Background="White"
                                            BorderThickness="1"
                                            BorderBrush="#dee2e6"
                                            MaxHeight="500">

                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Due Date" Binding="{Binding FormattedDueDate}" Width="100"/>
                                            <DataGridTextColumn Header="Invoice Ref" Binding="{Binding InvoiceReference}" Width="100"/>
                                            <DataGridTextColumn Header="Supplier" Binding="{Binding SupplierName}" Width="120"/>
                                            <DataGridTextColumn Header="Vessel" Binding="{Binding VesselName}" Width="120"/>
                                            <DataGridTextColumn Header="Amount" Binding="{Binding FormattedValue}" Width="120"/>
                                            <DataGridTextColumn Header="USD Amount" Binding="{Binding TotalValueUSD, StringFormat=C2}" Width="100"/>
                                            <DataGridTextColumn Header="Status" Binding="{Binding StatusText}" Width="120"/>
                                            <DataGridTextColumn Header="Receipt Date" Binding="{Binding FormattedReceiptDate}" Width="100"/>
                                            <DataGridTextColumn Header="Aging" Binding="{Binding AgingCategory}" Width="100"/>
                                            <DataGridTemplateColumn Header="Action" Width="120">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Button Content="💳 Pay Invoice" 
                                                               Background="#28a745" 
                                                               Foreground="White" 
                                                               BorderThickness="0" 
                                                               Padding="8,4" 
                                                               FontSize="11"
                                                               FontWeight="SemiBold"
                                                               Click="PayInvoice_Click"
                                                               Tag="{Binding PurchaseId}"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </TabItem>

                            <!-- Aging Analysis Tab -->
                            <TabItem Header="📊 Aging Analysis">
                                <StackPanel Margin="20">
                                    <TextBlock Text="Payment Aging by Supplier" FontSize="16" FontWeight="SemiBold" 
                                            Margin="0,0,0,15" Foreground="#2c3e50"/>

                                    <DataGrid x:Name="AgingAnalysisGrid" 
                                            AutoGenerateColumns="False" 
                                            CanUserAddRows="False"
                                            CanUserDeleteRows="False"
                                            GridLinesVisibility="Horizontal"
                                            HeadersVisibility="Column"
                                            Background="White"
                                            BorderThickness="1"
                                            BorderBrush="#dee2e6"
                                            MaxHeight="500">

                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Supplier" Binding="{Binding SupplierName}" Width="150"/>
                                            <DataGridTextColumn Header="Currency" Binding="{Binding Currency}" Width="80"/>
                                            <DataGridTextColumn Header="Total Outstanding" Binding="{Binding FormattedOutstanding}" Width="140"/>
                                            <DataGridTextColumn Header="Total Overdue" Binding="{Binding FormattedOverdue}" Width="120"/>
                                            <DataGridTextColumn Header="Total Invoices" Binding="{Binding TotalInvoices}" Width="100"/>
                                            <DataGridTextColumn Header="Overdue Invoices" Binding="{Binding OverdueInvoices}" Width="120"/>
                                            <DataGridTextColumn Header="Avg Days Overdue" Binding="{Binding AvgDaysOverdue, StringFormat=N1}" Width="130"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </TabItem>

                            <!-- NEW: Paid Invoices Tab -->
                            <TabItem Header="✅ Paid Invoices">
                                <StackPanel Margin="20">
                                    <TextBlock Text="All Paid Invoices (Most Recent First)" FontSize="16" FontWeight="SemiBold" 
                                            Margin="0,0,0,15" Foreground="#2c3e50"/>

                                    <DataGrid x:Name="PaidInvoicesGrid" 
                                            AutoGenerateColumns="False" 
                                            CanUserAddRows="False"
                                            CanUserDeleteRows="False"
                                            GridLinesVisibility="Horizontal"
                                            HeadersVisibility="Column"
                                            Background="White"
                                            BorderThickness="1"
                                            BorderBrush="#dee2e6"
                                            MaxHeight="500">

                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Payment Date" Binding="{Binding FormattedPaymentDate}" Width="110"/>
                                            <DataGridTextColumn Header="Invoice Ref" Binding="{Binding InvoiceReference}" Width="100"/>
                                            <DataGridTextColumn Header="Supplier" Binding="{Binding SupplierName}" Width="120"/>
                                            <DataGridTextColumn Header="Vessel" Binding="{Binding VesselName}" Width="120"/>
                                            <DataGridTextColumn Header="Original Amount" Binding="{Binding FormattedValue}" Width="120"/>
                                            <DataGridTextColumn Header="USD Amount" Binding="{Binding TotalValueUSD, StringFormat=C2}" Width="100"/>
                                            <DataGridTextColumn Header="Due Date" Binding="{Binding FormattedDueDate}" Width="100"/>
                                            <DataGridTextColumn Header="Receipt Date" Binding="{Binding FormattedReceiptDate}" Width="100"/>
                                            <DataGridTextColumn Header="Status" Width="80">
                                                <DataGridTextColumn.Binding>
                                                    <Binding Source="PAID"/>
                                                </DataGridTextColumn.Binding>
                                            </DataGridTextColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </TabItem>
                        </TabControl>
                    </Grid>
                </TabItem>

                <TabItem Header="📦 Inventory Valuation">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <!-- Controls -->
                            <RowDefinition Height="Auto"/>
                            <!-- Summary -->
                            <RowDefinition Height="*"/>
                            <!-- Content -->
                        </Grid.RowDefinitions>

                        <!-- Controls -->
                        <Border Grid.Row="0" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" 
                                CornerRadius="8" Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Orientation="Horizontal">
                                    <Button x:Name="GenerateInventoryBtn" Content="📦 Generate Inventory Report" 
                                          Background="#007bff" Foreground="White" BorderThickness="0" 
                                          Padding="15,10" FontWeight="SemiBold"
                                          Click="GenerateInventory_Click"/>

                                    <TextBlock Text="Real-time FIFO inventory valuation" 
                                        VerticalAlignment="Center" Margin="20,0,0,0" 
                                        FontStyle="Italic" Foreground="Gray"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <Button x:Name="ExportInventoryBtn" Content="📤 Export" 
                                          Background="#28a745" Foreground="White" BorderThickness="0" 
                                          Padding="15,10" FontWeight="SemiBold"
                                          Click="ExportInventory_Click"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Summary Cards -->
                        <Border Grid.Row="1" Background="#e8f5e8" BorderBrush="#4caf50" BorderThickness="1" 
                                CornerRadius="8" Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                    <TextBlock Text="📦 Total Inventory (L)" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="InventoryTotalLitersText" Text="0.000 L" FontSize="16" FontWeight="Bold" 
                                                HorizontalAlignment="Center" Foreground="#2e7d32"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                    <TextBlock Text="⚖️ Total Inventory (T)" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="InventoryTotalTonsText" Text="0.000 T" FontSize="16" FontWeight="Bold" 
                                                HorizontalAlignment="Center" Foreground="#2e7d32"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                    <TextBlock Text="💰 FIFO Value" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="InventoryTotalFIFOValueText" Text="$0.00" FontSize="16" FontWeight="Bold" 
                                                HorizontalAlignment="Center" Foreground="#2e7d32"/>
                                </StackPanel>

                                <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                    <TextBlock Text="📄 Purchase Lots" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="InventoryPurchaseLotsText" Text="0" FontSize="16" FontWeight="Bold" 
                                                HorizontalAlignment="Center" Foreground="#2e7d32"/>
                                </StackPanel>

                                <StackPanel Grid.Column="4" HorizontalAlignment="Center">
                                    <TextBlock Text="💲 Avg Cost/Liter" FontWeight="SemiBold" HorizontalAlignment="Center" FontSize="12"/>
                                    <TextBlock x:Name="InventoryAvgCostPerLiterText" Text="$0.000000" FontSize="16" FontWeight="Bold" 
                                                HorizontalAlignment="Center" Foreground="#2e7d32"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Inventory Tabs -->
                        <TabControl Grid.Row="2" x:Name="InventoryTabControl">

                            <!-- Inventory by Vessel Tab -->
                            <TabItem Header="🚢 By Vessel">
                                <StackPanel Margin="20">
                                    <TextBlock Text="Current Inventory by Vessel (FIFO Valuation)" FontSize="16" FontWeight="SemiBold" 
                                            Margin="0,0,0,15" Foreground="#2c3e50"/>

                                    <DataGrid x:Name="VesselInventoryGrid" 
                                            AutoGenerateColumns="False" 
                                            CanUserAddRows="False"
                                            CanUserDeleteRows="False"
                                            GridLinesVisibility="Horizontal"
                                            HeadersVisibility="Column"
                                            Background="White"
                                            BorderThickness="1"
                                            BorderBrush="#dee2e6"
                                            MaxHeight="500">

                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Vessel" Binding="{Binding VesselName}" Width="120"/>
                                            <DataGridTextColumn Header="Type" Binding="{Binding VesselType}" Width="80"/>
                                            <DataGridTextColumn Header="Route" Binding="{Binding Route}" Width="180"/>
                                            <DataGridTextColumn Header="Inventory (L)" Binding="{Binding CurrentInventoryL, StringFormat=N3}" Width="120"/>
                                            <DataGridTextColumn Header="Inventory (T)" Binding="{Binding CurrentInventoryT, StringFormat=N3}" Width="120"/>
                                            <DataGridTextColumn Header="FIFO Value" Binding="{Binding FIFOValueUSD, StringFormat=C2}" Width="120"/>
                                            <DataGridTextColumn Header="Cost/L USD" Binding="{Binding AvgCostPerLiterUSD, StringFormat=C6}" Width="120"/>
                                            <DataGridTextColumn Header="Cost/T USD" Binding="{Binding AvgCostPerTonUSD, StringFormat=C2}" Width="120"/>
                                            <DataGridTextColumn Header="Lots" Binding="{Binding PurchaseLotsCount}" Width="60"/>
                                            <DataGridTextColumn Header="Oldest Date" Binding="{Binding FormattedOldestDate}" Width="100"/>
                                            <DataGridTextColumn Header="Days Old" Binding="{Binding DaysOldestInventory}" Width="80"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </TabItem>

                            <!-- Inventory by Supplier Tab -->
                            <TabItem Header="🏢 By Supplier">
                                <StackPanel Margin="20">
                                    <TextBlock Text="Current Inventory by Supplier (FIFO Valuation)" FontSize="16" FontWeight="SemiBold" 
                                            Margin="0,0,0,15" Foreground="#2c3e50"/>

                                    <DataGrid x:Name="SupplierInventoryGrid" 
                                            AutoGenerateColumns="False" 
                                            CanUserAddRows="False"
                                            CanUserDeleteRows="False"
                                            GridLinesVisibility="Horizontal"
                                            HeadersVisibility="Column"
                                            Background="White"
                                            BorderThickness="1"
                                            BorderBrush="#dee2e6"
                                            MaxHeight="500">

                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Supplier" Binding="{Binding SupplierName}" Width="120"/>
                                            <DataGridTextColumn Header="Currency" Binding="{Binding Currency}" Width="80"/>
                                            <DataGridTextColumn Header="Inventory (L)" Binding="{Binding RemainingInventoryL, StringFormat=N3}" Width="120"/>
                                            <DataGridTextColumn Header="Inventory (T)" Binding="{Binding RemainingInventoryT, StringFormat=N3}" Width="120"/>
                                            <DataGridTextColumn Header="FIFO Value" Binding="{Binding FormattedFIFOValueOriginal}" Width="120"/>
                                            <DataGridTextColumn Header="USD Value" Binding="{Binding FIFOValueUSD, StringFormat=C2}" Width="100"/>
                                            <DataGridTextColumn Header="Cost/L" Binding="{Binding FormattedAvgCostOriginal}" Width="120"/>
                                            <DataGridTextColumn Header="Cost/L USD" Binding="{Binding AvgCostPerLiterUSD, StringFormat=C6}" Width="120"/>
                                            <DataGridTextColumn Header="Lots" Binding="{Binding PurchaseLotsCount}" Width="60"/>
                                            <DataGridTextColumn Header="Vessels" Binding="{Binding VesselsSupplied}" Width="70"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </TabItem>

                            <!-- Purchase Lot Details Tab -->
                            <TabItem Header="📄 Purchase Lots">
                                <StackPanel Margin="20">
                                    <TextBlock Text="Individual Purchase Lots (FIFO Order)" FontSize="16" FontWeight="SemiBold" 
                                            Margin="0,0,0,15" Foreground="#2c3e50"/>

                                    <DataGrid x:Name="PurchaseLotsGrid" 
                                            AutoGenerateColumns="False" 
                                            CanUserAddRows="False"
                                            CanUserDeleteRows="False"
                                            GridLinesVisibility="Horizontal"
                                            HeadersVisibility="Column"
                                            Background="White"
                                            BorderThickness="1"
                                            BorderBrush="#dee2e6"
                                            MaxHeight="500">

                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Purchase Date" Binding="{Binding FormattedPurchaseDate}" Width="100"/>
                                            <DataGridTextColumn Header="Invoice Ref" Binding="{Binding InvoiceReference}" Width="100"/>
                                            <DataGridTextColumn Header="Vessel" Binding="{Binding VesselName}" Width="100"/>
                                            <DataGridTextColumn Header="Supplier" Binding="{Binding SupplierName}" Width="100"/>
                                            <DataGridTextColumn Header="Original (L)" Binding="{Binding OriginalQuantityL, StringFormat=N3}" Width="100"/>
                                            <DataGridTextColumn Header="Remaining (L)" Binding="{Binding RemainingQuantityL, StringFormat=N3}" Width="110"/>
                                            <DataGridTextColumn Header="Remaining (T)" Binding="{Binding RemainingQuantityT, StringFormat=N3}" Width="110"/>
                                            <DataGridTextColumn Header="% Remaining" Binding="{Binding PercentageRemaining, StringFormat=N1}" Width="100"/>
                                            <DataGridTextColumn Header="FIFO Value" Binding="{Binding FormattedRemainingValue}" Width="120"/>
                                            <DataGridTextColumn Header="USD Value" Binding="{Binding RemainingValueUSD, StringFormat=C2}" Width="100"/>
                                            <DataGridTextColumn Header="Cost/L" Binding="{Binding FormattedCostPerLiter}" Width="120"/>
                                            <DataGridTextColumn Header="Days in Inventory" Binding="{Binding DaysInInventory}" Width="120"/>
                                            <DataGridTextColumn Header="Aging" Binding="{Binding AgingCategory}" Width="120"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </TabItem>
                        </TabControl>
                    </Grid>
                </TabItem>

                <!-- More tabs will be added here -->
            </TabControl>
        </Grid>
    </ScrollViewer>
</UserControl>